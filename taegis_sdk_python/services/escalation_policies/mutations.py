"""EscalationPolicies Mutation."""

# pylint: disable=no-member, unused-argument, too-many-locals, duplicate-code, wildcard-import, unused-wildcard-import, cyclic-import


# Autogenerated
# DO NOT MODIFY

from __future__ import annotations

import logging
from typing import TYPE_CHECKING, Any, Dict, List, Optional, Tuple, Union

from taegis_sdk_python import GraphQLNoRowsInResultSetError
from taegis_sdk_python._consts import TaegisEnum
from taegis_sdk_python.services.escalation_policies.types import *
from taegis_sdk_python.utils import (
    build_output_string,
    parse_union_result,
    prepare_input,
)

if TYPE_CHECKING:  # pragma: no cover
    from taegis_sdk_python.services.escalation_policies import EscalationPoliciesService

log = logging.getLogger(__name__)


class TaegisSDKEscalationPoliciesMutation:
    """Taegis Escalation_policies Mutation operations."""

    def __init__(self, service: EscalationPoliciesService):
        self.service = service

    def create_escalation_policy(
        self, input_: CreateEscalationPolicyInput
    ) -> EscalationPolicy:
        """Create a new escalation policy."""
        endpoint = "createEscalationPolicy"

        result = self.service.execute_mutation(
            endpoint=endpoint,
            variables={
                "input": prepare_input(input_),
            },
            output=build_output_string(
                EscalationPolicy,
                exclude_deprecated_output=self.service.exclude_deprecated_output,
            ),
        )
        if result.get(endpoint) is not None:
            return EscalationPolicy.from_dict(result.get(endpoint))
        raise GraphQLNoRowsInResultSetError("for mutation createEscalationPolicy")

    def update_escalation_policy(
        self, input_: UpdateEscalationPolicyInput
    ) -> EscalationPolicy:
        """Update an existing escalation policy."""
        endpoint = "updateEscalationPolicy"

        result = self.service.execute_mutation(
            endpoint=endpoint,
            variables={
                "input": prepare_input(input_),
            },
            output=build_output_string(
                EscalationPolicy,
                exclude_deprecated_output=self.service.exclude_deprecated_output,
            ),
        )
        if result.get(endpoint) is not None:
            return EscalationPolicy.from_dict(result.get(endpoint))
        raise GraphQLNoRowsInResultSetError("for mutation updateEscalationPolicy")

    def delete_escalation_policy(
        self, input_: DeleteEscalationPolicyInput
    ) -> EscalationPolicy:
        """Delete an existing escalation policy.
        This is a hard delete and will remove the escalation policy from the system entirely.
        Policies that are in use by notification rules will need to be unlinked before they can be deleted..
        """
        endpoint = "deleteEscalationPolicy"

        result = self.service.execute_mutation(
            endpoint=endpoint,
            variables={
                "input": prepare_input(input_),
            },
            output=build_output_string(
                EscalationPolicy,
                exclude_deprecated_output=self.service.exclude_deprecated_output,
            ),
        )
        if result.get(endpoint) is not None:
            return EscalationPolicy.from_dict(result.get(endpoint))
        raise GraphQLNoRowsInResultSetError("for mutation deleteEscalationPolicy")
